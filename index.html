<!DOCTYPE html>
<html class="full-height">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Hej snygging!</title>
    <link rel="stylesheet" type="text/css" href="style.css"/>
  </head>
  <body class="container">
    <div class="searchbar">
      <input class="search-input" type="text"/>
      <button onclick="search()">Search</button>
    </div>
    <p id="books"></p>
  </body>

  <script>
    const apiUrl="https://www.googleapis.com/books/v1/volumes?q="
    function search() {
      const url = buildUrl()
      getBooks(url);
    }
  
    function getBooks(url) {
      const https= new XMLHttpRequest();
      https.open("GET", url);
      https.send();
      https.onreadystatechange=function() {
        if(this.readyState==4 && this.status==200) {
          showTitles(https.responseText)
        }
      }
    }

    function buildUrl() {
      const value = document.getElementsByClassName("search-input")[0].value
      const url = apiUrl  + value
      return url
    } 

    function showTitles(responseText) {
      const bookElement = document.getElementById("books");

      const responseJson = JSON.parse(responseText);
      bookElement.innerHTML = ""
      for (let i = 0; i < responseJson.items.length; i++) {
        const book = responseJson.items[i];
        const title = book.volumeInfo.title;

        bookElement.innerHTML = bookElement.innerHTML + "<br/>" + title;
      }
    }

  </script>
</html>
